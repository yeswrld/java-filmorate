DROP ALL OBJECTS;

CREATE TABLE IF NOT EXISTS mpa
(
id INTEGER NOT NULL AUTO_INCREMENT,
name CHARACTER VARYING NOT NULL,
CONSTRAINT MPA_PK PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS films
(
id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name varchar not null,
description varchar,
release_date date,
duration INTEGER,
mpa_id INTEGER REFERENCES mpa(id)
);

CREATE TABLE IF NOT EXISTS genres
(
id    INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name varchar
);

CREATE TABLE IF NOT EXISTS films_genres
(
film_id INTEGER REFERENCES FILMS (id),
genre_id INTEGER REFERENCES GENRES (id)
);

CREATE TABLE IF NOT EXISTS users
(
id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
email varchar NOT NULL,
login varchar NOT NULL,
name varchar NOT NULL,
birthday date
);

CREATE TABLE IF NOT EXISTS likes
(
user_id INTEGER REFERENCES users(id),
film_id INTEGER REFERENCES films(id)
);

CREATE TABLE IF NOT EXISTS friends
(
user_id int REFERENCES USERS (id),
friend_id INTEGER REFERENCES USERS (id),
confirmed BOOLEAN
);



